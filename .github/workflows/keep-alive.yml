name: Keep Supabase Alive (Multi-Project)

on:
  schedule:
    - cron: "0 9 * * *" # Se ejecuta todos los d√≠as a las 9:00 AM UTC
  workflow_dispatch: # Permite ejecutarlo manualmente desde GitHub

jobs:
  wake-up-projects:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      # PROYECTO 1: DH OPORTUNIDADES
      - name: Wake up DH OPORTUNIDADES
        env:
          URL: ${{ secrets.SUPABASE_URL_DH }}
          KEY: ${{ secrets.SUPABASE_KEY_DH }}
        run: |
          if [ -z "$URL" ]; then
            echo "‚ö†Ô∏è Faltan secretos para DH OPORTUNIDADES, saltando..."
          else
            echo "üì° Enviando se√±al a DH OPORTUNIDADES..."
            curl -f -X GET "$URL/rest/v1/" \
            -H "apikey: $KEY" \
            -H "Authorization: Bearer $KEY"
            echo "‚úÖ DH OPORTUNIDADES despertado."
          fi

      # PROYECTO 2: UFLP
      - name: Wake up UFLP
        env:
          URL: ${{ secrets.SUPABASE_URL_UFLP }}
          KEY: ${{ secrets.SUPABASE_KEY_UFLP }}
        run: |
          if [ -z "$URL" ]; then
            echo "‚ö†Ô∏è Faltan secretos para UFLP, saltando..."
          else
            echo "üì° Enviando se√±al a UFLP..."
            curl -f -X GET "$URL/rest/v1/" \
            -H "apikey: $KEY" \
            -H "Authorization: Bearer $KEY"
            echo "‚úÖ UFLP despertado."
          fi
